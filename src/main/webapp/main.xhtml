<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    
<!--meta http-equiv="refresh" content="{pageContext.session.maxInactiveInterval};url=login.xhtml" /--> 

<f:event type="preRenderView" listener="#{userBean.checkNotLoggedin}" />
<f:view>
    <h:head>
        <title>ABACUS - Powered by CEDIANT</title>
        <h:outputStylesheet library="css" name="main.css" />
        <h:outputStylesheet library="jqPlot" name="jquery.jqplot.css" />
    </h:head>
    <h:body onload="#{userBean.setActiveTab('Dashboard')}; #{userBean.changeSub('Main')};" 
            onunload="#{userBean.setActiveTab('Dashboard')}; #{userBean.changeSub('Main')};">                                      
        <!-- 
        onload="buildgraphs('{dashboardBean.strOne}', '{dashboardBean.strTwo}', {dashBoardBean.interval}); 
                             {dashboardBean.setPollEnabled(true)}; 
                             {userBean.setActiveTab('Dashboard')}; 
                             {userBean.changeSub('Main')};" 
        -->
        <!--
        onunload="{dashboardBean.setPollEnabled(true)}; 
                  {userBean.setActiveTab('Dashboard')}; 
                  {userBean.changeSub('Main')};">                                      
        -->
        
        <h:outputScript library="jqPlot" name="jquery.min.js"/>
        <h:outputScript library="jqPlot" name="jquery.jqplot.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.pieRenderer.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.donutRenderer.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.highlighter.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.cursor.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.cursor.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.dateAxisRenderer.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.enhancedLegendRenderer.min.js"/>
        <!--h:outputScript library="jqPlot" name="plugins/jqplot.pieLegendRenderer.min.js"/-->
        
        <h:outputScript library="jqPlot" name="plugins/jqplot.barRenderer.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.categoryAxisRenderer.min.js"/>
        <h:outputScript library="jqPlot" name="plugins/jqplot.pointLabels.min.js"/>
        
        <h:outputScript library="js" name="abacus.js"/>    
        
        <!--rich:notify stayTime="2000" 
                     sticky="false" 
                     nonblocking="true"
                     showShadow="true"
                     showCloseButton="true" 
                     detail="Detail" 
                     escape="false">
            <f:facet name="summary">
                INFO
            </f:facet>
        </rich:notify-->        
        
        <rich:notifyMessages stayTime="2000" 
                             sticky="false"
                             nonblocking="true"
                             showCloseButton="true"
                             showShadow="true"
                             escape="false">
            <f:facet name="summary">
                INFO
            </f:facet>
        </rich:notifyMessages>                        
                
        <h:form> 
            <a4j:poll id="testsTablePoll" 
                      interval="5000" 
                      enabled="#{testsBean.testsRunning.size()>0}" 
                      render="testsHistoryTable testsTablePoll" />
        </h:form>
        
        <div id="wrapDiv">                       
        <rich:panel id="headerPanel">  
            <h:panelGrid columns="2">
                <h:panelGrid>
                    <h:link outcome="home">
                    <h:graphicImage library="img" 
                                    name="#{userBean.logoImg}" 
                                    height="32px" />
                    </h:link>
                </h:panelGrid>
                <h:panelGrid id="headerGrid" columns="7">    
                    <h:outputLink styleClass="headerLinks">Language</h:outputLink>
                    <h:outputLink styleClass="headerLinks">Help</h:outputLink>
                    <h:outputLink styleClass="headerLinks">About</h:outputLink>
                    <h:graphicImage id="separatorHeader" 
                                    library="img" 
                                    name="lineSeparator.png" 
                                    height="32px" />
                    <h:outputText id ="welcomeText" value="Welcome" />
                    <h:outputText id="welcomeName"                              
                                  value="#{userBean.username}"/>
                    <h:outputLink value="logout.xhtml">
                        <h:graphicImage library="img" name="logout.png" height="32px" />
                    </h:outputLink>                 
                </h:panelGrid>
            </h:panelGrid>                        
        </rich:panel>
                
        <h:form>
            <rich:collapsiblePanel id="statusPanel" 
                                   header="Status" 
                                   switchType="client"
                                   bodyClass="statusStyle"
                                   headerClass="headerStatus">
                <h:panelGrid columns="5"                            
                             width="100%"
                             styleClass="outerPanel"
                             cellspacing="0">
                    <h:panelGrid id="status_1_panel" 
                                 styleClass="innerPanel">
                        <h:outputText value="INFO" styleClass="subStatusTitle" />
                        <h:panelGrid columns="2" >                        
                            <h:graphicImage library="img" name="serverIcon.png" height="48px;" 
                                            styleClass="statusGraphic" />
                                <h:panelGrid columns="2" columnClasses="subStatusCol">
                                <h:outputText value="Name: " />
                                <h:outputText value="miguel-Ubuntu" styleClass="subStatusTitle" />
                                <h:outputText value="IP: " />
                                <h:outputText value="192.10.0.100" styleClass="subStatusTitle" />
                                <h:outputText value="Status: " />
                                <h:graphicImage library="img" name="greenOkIcon.png" height="16px" styleClass="subStatusTitle" />
                                <h:outputText value="GPU: " />
                                <h:outputText value="Nvidia" styleClass="subStatusTitle" />
                            </h:panelGrid>
                        </h:panelGrid>                    
                    </h:panelGrid>
                    <h:panelGrid id="status_2_panel" styleClass="innerPanel">
                        <h:outputText value="COMPUTER" styleClass="subStatusTitle" />                    
                        <div id="computerBarDiv" style="height: 65px; width: 176px;" />
                        <h:outputScript library="jqPlot" name="createComputerGraph.js"/>
                    </h:panelGrid>
                    <h:panelGrid id="status_3_panel" styleClass="innerPanel">
                        <h:outputText value="GPU" styleClass="subStatusTitle" />
                        <div id="gpuBarDiv" style="height: 65px; width: 118px;" />
                        <h:outputScript library="jqPlot" name="createGpuGraph.js"/>                                       
                    </h:panelGrid>
                    <h:panelGrid id="status_4_panel" styleClass="innerPanel">
                        <h:outputText value="SYSTEM HEALTH" styleClass="subStatusTitle" />                    
                        <h:panelGrid columns="8" columnClasses="subStatusCol2,subStatusCol2,subStatusCol2,subStatusCol2">
                            <div id="queuedBarDiv" style="height: 65px; width: 118px;" />   
                            <h:outputScript library="jqPlot" name="createQueuedGraph.js"/>
                            <div id="runningBarDiv" style="height: 65px; width: 118px;" /> 
                            <h:outputScript library="jqPlot" name="createRunningGraph.js"/>
                            <div id="loadBarDiv" style="height: 65px; width: 118px;" />                                                
                            <h:outputScript library="jqPlot" name="createLoadGraph.js"/>                        
                            <div id="diskBarDiv" style="height: 65px; width: 118px;"/>  
                            <h:outputScript library="jqPlot" name="createDiskGraph.js"/>
                        </h:panelGrid>                    
                    </h:panelGrid>                
                    <h:panelGrid id="status_5_panel" styleClass="innerPanel">
                        <a4j:commandButton value="Refresh" 
                                           render="outerStatusPanel"/>
                    </h:panelGrid>                                
                </h:panelGrid>
            </rich:collapsiblePanel>
        </h:form>               
        
        <h:form>
            <rich:popupPanel id="resultPopup" modal="false" autosized="true" resizeable="false"> 
                <f:facet name="header">
                    <h:outputText value="Result" />
                </f:facet>
                <f:facet name="controls">
                    <h:outputLink value="#" onclick="#{rich:component('resultPopup')}.hide(); return false;">
                        X                    
                    </h:outputLink>
                </f:facet>
                <h:graphicImage library="img" name="redSphere.png" />
            </rich:popupPanel>
        </h:form>
        
        <h:form>
            <rich:popupPanel id="JSPopup" 
                             modal="false"
                             autosized="true" 
                             moveable="true"
                             onshow="init('#{nBodysBean.numParticles}', '#{nBodysBean.numSteps}', '#{nBodysBean.coordinates}')"
                             left="0px"
                             top="0px"> 
                <f:facet name="header">
                    <h:outputText value="Result" />
                </f:facet>
                <f:facet name="controls">
                    <h:outputLink value="#" onclick="#{rich:component('JSPopup')}.hide(); return false;">
                        X                    
                    </h:outputLink>
                </f:facet>       
                <div id="nBodyDiv">
                    <h:outputScript library="threeJS" name="three.min.js"/>
                    <!--h:outputScript library="js" name="rotatingCube.js" /-->
                    <h:outputScript library="threeJS" name="nbody.js" />
                </div>
            </rich:popupPanel>
            <!--a4j:status onstart="{rich:component('statPane')}.show()" 
                        onstop="{rich:component('statPane')}.hide()" /-->
        </h:form>                
        
        <div id="mainDiv">
        <!--h:form id="generalForm"-->
            <h:form>
                <a4j:jsFunction name="setActiveTab"    
                                render="poll,dashboardGrid,managementPanel,tasksPanel,myAccountPanel,myMonitorPanel">
                    <a4j:param name="activeTab" assignTo="#{userBean.activeTab}"/>
                </a4j:jsFunction>
            </h:form>
            <h:form>
                <a4j:jsFunction name="setActiveSub" 
                                render="subManagementPanel,subTasksPanel,subAccountPanel,subMonitorPanel">
                    <a4j:param name="activeSub" assignTo="#{userBean.activeSub}"/>
                </a4j:jsFunction> 
            </h:form>        

            <!--h:form-->
            <rich:tabPanel id="generalTabPanel"
                           switchType="client" 
                           activeItem="#{userBean.activeTab==null?'Dashboard':userBean.activeTab}"
                           tabActiveHeaderClass="tabActive">

                <!--div id="externdiv" style="width: 48%;" /-->
                <!--div id="piechart" style="width: 48%;" /-->  
                <rich:tab header="Dashboard"
                          id="Dashboard"
                          onenter="setActiveTab('Dashboard'); buildgraphs('#{dashboardBean.strOne}', '#{dashboardBean.strTwo}', #{dashboardBean.interval});"                      
                          render="poll,dashboardGrid"
                          contentClass="contentTab">  
                    <f:facet name="header">
                        <h:panelGroup>
                            <h:panelGrid columns="2" columnClasses="middleCol,middleCol">
                                <h:graphicImage library="img" name="dashboard.png" height="18px;"/>
                                <h:outputLabel value="Dashboard"/>
                            </h:panelGrid>
                        </h:panelGroup>
                    </f:facet>                                    
                    <!--f:ajax event="click"  
                            render="poll,dashboardGrid"/-->                 

                    <!--f:ajax event="click" 
                            execute="@form" 
                            render="dashboardGrid" 
                            listener="{dashboardBean.updateData(5)}"
                            onevent="buildplots('{dashboardBean.strOne}','{dashboardBean.strTwo}')" /--> 
                    <!--
                    onbegin="buildplots('{dashboardBean.strOne}','{dashboardBean.strTwo}')"
                    render="poll"
                    execute="@form"
                    --> 
                    <!--h:form>
                        <a4j:jsFunction name="buildplots" render="Dashboard">
                            <a4j:param name="strOne" assignTo="{dashboardBean.strOne}" />
                            <a4j:param name="strTwo" assignTo="{dashboardBean.strTwo}" />
                        </a4j:jsFunction>
                    </h:form-->

                    <c:if test="false">
                        <h:outputScript library="jqPlot" name="createplots.js"/> 
                        <h:panelGrid columns="2" style="width: 100%" id="dashboardGrid">                                        
                            <h:panelGrid style="width: 100%;">
                                <div id="chartdiv" style="width: 100%;" />
                            </h:panelGrid>
                            <h:panelGrid style="width: 100%;">
                                <div id="piediv" style="width: 100%;" />
                            </h:panelGrid>                    
                        </h:panelGrid>
                        <h:form id="pollForm">
                            <a4j:poll id="poll"                              
                                      interval="5000" 
                                      enabled="#{dashboardBean.pollEnabled}" 
                                      render="poll,dashboardGrid"
                                      action="#{dashboardBean.updateData(5)}" 
                                      execute="@form"
                                      oncomplete="buildgraphs('#{dashboardBean.strOne}', '#{dashboardBean.strTwo}', #{dashboardBean.interval})"/>      
                                <div id="hiddenId">
                                    <h:inputHidden id="hiddenOne" value="#{dashboardBean.strOne}" />
                                    <h:inputHidden id="hiddenTwo" value="#{dashboardBean.strTwo}" />
                                </div>
                        </h:form>
                    </c:if>
                    
                    <h:outputText value="TASKS" styleClass="dashboardSubtitle" />
                    <h:panelGrid id="tasksDashboard" columns="2" styleClass="dashboardPanelAndSpace">                                                                    
                        <h:panelGrid>                            
                            <div id="dashboardFirstDiv" style="height: 200px; width: 500px;" />
                            <h:outputScript library="jqPlot" name="createTasksGraph.js"/>     
                            <!--h:graphicImage library="img" name="Screenshot1.png" width="100%" /-->
                        </h:panelGrid> 
                        <h:form>
                            <rich:dataTable id="procSummaryTable" 
                                            value="#{processesBean.getLastProcesses(5)}" 
                                            var="process" 
                                            iterationStatusVar="it"                                     
                                            rows="5">
                                <rich:column>
                                    <f:facet name="header">ID</f:facet>
                                    <h:outputText value="#{process.idProcess}" />
                                </rich:column>

                                <rich:column>
                                    <f:facet name="header">User</f:facet>
                                    <h:outputText value="#{process.user.userName}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Name</f:facet>
                                    <h:outputText value="#{process.name}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Type</f:facet>
                                    <h:outputText value="#{process.type}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Priority</f:facet>
                                    <h:outputText value="#{process.priority}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Status</f:facet>                                                        
                                    <h:outputText value="#{process.status}" 
                                                  style="color: green;" 
                                                  rendered="#{process.status.equalsIgnoreCase('finished')}"/>
                                    <h:outputText value="#{process.status}" 
                                                  style="color: red;" 
                                                  rendered="#{process.status.equalsIgnoreCase('running')}"/>
                                    <h:outputText value="#{process.status}" 
                                                  style="color: blue;" 
                                                  rendered="#{process.status.equalsIgnoreCase('waiting')}"/>                                                      
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Start time</f:facet>
                                    <h:outputText value="#{process.startTime}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">End time</f:facet>
                                    <h:outputText value="#{process.endTime}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Actions</f:facet>
                                    <h:selectOneMenu value="#{processesBean.action}">
                                        <f:selectItem noSelectionOption="true"
                                                      id="noOption"/>
                                        <f:selectItem itemLabel="Cancel" 
                                                      itemValue="cancel"
                                                      itemDisabled="#{processesBean.isFinished(process.idProcess)}"/>
                                        <f:selectItem itemLabel="Force Start" 
                                                      itemValue="force"
                                                      itemDisabled="#{not processesBean.isWaiting(process.idProcess)}"/>
                                    </h:selectOneMenu>
                                </rich:column>
                                <f:facet name="footer">
                                    <rich:column colspan="8">
                                        <a4j:commandButton id="procButton"
                                                           value="Submit" 
                                                           action="#{processesBean.executeActions}"                                                       
                                                           render="procSummaryTable" />
                                    </rich:column>
                                </f:facet>                        
                            </rich:dataTable> 
                        </h:form>
                        <!--h:graphicImage library="img" name="Screenshot3.png" width="100%" /-->
                    </h:panelGrid> 
                    <h:outputText value="SYSTEM" styleClass="dashboardSubtitle" />
                    <h:panelGrid id="systemDashboard" columns="2" 
                                 styleClass="dashboardPanel" width="100%"
                                 columnClasses="dashboardCols,dashboardCols">
                        <h:panelGrid>
                            <div id="dashboardSecondDiv" style="height: 200px; width: 500px;" />
                            <h:outputScript library="jqPlot" name="createSystemGraph.js"/>
                            <!--h:graphicImage library="img" name="Screenshot2.png" width="100%" /-->
                        </h:panelGrid>
                        <h:form>
                            <rich:dataTable id="nodesSummaryTable" 
                                            value="#{nodesBean.getLastNodes(5)}" 
                                            var="node" 
                                            iterationStatusVar="it"                                     
                                            rows="5">
                                <rich:column>
                                    <f:facet name="header">ID</f:facet>
                                    <h:outputText value="#{node.idNode}" />                                
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Hostname</f:facet>
                                    <h:outputText value="#{node.hostname}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">IP</f:facet>
                                    <h:outputText value="#{node.ip}" />
                                </rich:column>
                                <rich:column styleClass="subStatusCol2">
                                    <f:facet name="header">Status</f:facet>
                                    <!--h:outputText value="{node.status}" /-->
                                    <h:graphicImage library="img" 
                                                    name="greenOkIcon.png" 
                                                    rendered="#{node.status.equalsIgnoreCase('ok')}"
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="warningIcon.png" 
                                                    rendered="#{node.status.equalsIgnoreCase('warning')}" 
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="errorIcon.png" 
                                                    rendered="#{node.status.equalsIgnoreCase('error')}" 
                                                    height="24px"/>
                                </rich:column>
                                <rich:column styleClass="subStatusCol2">
                                    <f:facet name="header">CPU</f:facet>
                                    <!--h:outputText value="{node.cpu}" /-->
                                    <h:graphicImage library="img" 
                                                    name="greenOkIcon.png" 
                                                    rendered="#{node.cpu.equalsIgnoreCase('ok')}"
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="warningIcon.png" 
                                                    rendered="#{node.cpu.equalsIgnoreCase('warning')}" 
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="errorIcon.png" 
                                                    rendered="#{node.cpu.equalsIgnoreCase('error')}" 
                                                    height="24px"/>
                                </rich:column>
                                <rich:column styleClass="subStatusCol2">
                                    <f:facet name="header">Mem</f:facet>
                                    <!--h:outputText value="{node.mem}" /-->
                                    <h:graphicImage library="img" 
                                                    name="greenOkIcon.png" 
                                                    rendered="#{node.mem.equalsIgnoreCase('ok')}"
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="warningIcon.png" 
                                                    rendered="#{node.mem.equalsIgnoreCase('warning')}" 
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="errorIcon.png" 
                                                    rendered="#{node.mem.equalsIgnoreCase('error')}" 
                                                    height="24px"/>
                                </rich:column>
                                <rich:column styleClass="subStatusCol2">
                                    <f:facet name="header">Disk</f:facet>
                                    <!--h:outputText value="{node.disk}" /-->
                                    <h:graphicImage library="img" 
                                                    name="greenOkIcon.png" 
                                                    rendered="#{node.disk.equalsIgnoreCase('ok')}"
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="warningIcon.png" 
                                                    rendered="#{node.disk.equalsIgnoreCase('warning')}" 
                                                    height="24px"/>
                                    <h:graphicImage library="img" 
                                                    name="errorIcon.png" 
                                                    rendered="#{node.disk.equalsIgnoreCase('error')}" 
                                                    height="24px"/>
                                </rich:column>                            
                                <rich:column>
                                    <f:facet name="header">Actions</f:facet>
                                    <h:selectOneMenu value="">
                                        <f:selectItem noSelectionOption="true"
                                                      id="noOption"/>   
                                        <f:selectItem id="action1" itemLabel="action1"/>
                                        <f:selectItem id="action2" itemLabel="action2"/>
                                    </h:selectOneMenu>
                                </rich:column>
                                <f:facet name="footer">
                                    <rich:column colspan="8">
                                        <a4j:commandButton id="nodeButton"
                                                           value="Submit"                                                        
                                                           render="nodeSummaryTable" />
                                    </rich:column>
                                </f:facet>                        
                            </rich:dataTable>   
                        </h:form>
                    </h:panelGrid>                    
                    <h:panelGrid id="alertsUpdateDashboard" 
                                 columns="2" 
                                 cellspacing="0" 
                                 cellpadding="0"
                                 width="100%">                    
                        <h:panelGrid id="alertsDashboard" 
                                     cellspacing="0" 
                                     cellpadding="0"
                                     width="100%">
                            <h:outputText value="ALERTS" styleClass="dashboardSubtitle" />   
                            <h:panelGrid id="alertsInnerPanel"
                                         columns="5"                                          
                                         width="100%">
                                <h:panelGrid styleClass="alertPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="diskIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="Disk" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="2" styleClass="alertCritPositNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="2" styleClass="alertWarnPositNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                                <h:panelGrid styleClass="alertPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="cpuIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="CPU" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="0" styleClass="alertZeroNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="2" styleClass="alertWarnPositNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                                <h:panelGrid styleClass="alertPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="gpuIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="GPU" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="2" styleClass="alertCritPositNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="0" styleClass="alertZeroNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                                <h:panelGrid styleClass="alertPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="tempIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="TEMP" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="0" styleClass="alertZeroNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="1" styleClass="alertWarnPositNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                                <h:panelGrid styleClass="alertPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="errorIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="Errors" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="0" styleClass="alertZeroNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="0" styleClass="alertZeroNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                            </h:panelGrid>
                        </h:panelGrid>                    
                        <h:panelGrid id="updateDashboard" styleClass="verticalSeparator">
                            <h:panelGrid>
                                <h:outputText value="OTHERS" styleClass="dashboardSubtitle" />
                                <h:panelGrid styleClass="othersPanel" 
                                             columnClasses="alertColPanel">
                                    <h:panelGrid columns="2" 
                                                 columnClasses="subStatusCol2,subStatusCol2">                                        
                                        <h:graphicImage library="img" 
                                                        name="diskIcon.png" 
                                                        height="32px;" />
                                        <h:outputText value="Disk" 
                                                      styleClass="alertTitle"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" 
                                                 styleClass="alertInnerPanel" 
                                                 columnClasses="subStatusCol2,subStatusCol3,subStatusCol2" > 
                                        <h:outputText value="CRITICAL" styleClass="alertInnerTitle"/>
                                        <h:outputText value="" />
                                        <h:outputText value="WARNING" styleClass="alertInnerTitle"/>
                                        <h:outputText value="2" styleClass="alertCritPositNumber"/>
                                        <h:outputText value="|" styleClass="separator" />
                                        <h:outputText value="2" styleClass="alertWarnPositNumber"/>                                        
                                    </h:panelGrid>
                                </h:panelGrid>
                            </h:panelGrid>
                        </h:panelGrid>
                    </h:panelGrid>
                </rich:tab>                                                                                                                

                <rich:tab header="Management"
                          id="Management"
                          onenter="setActiveTab('Management')"
                          onleave="setActiveSub('Main')"
                          contentClass="richTabContent">
                    <f:facet name="header">
                        <h:panelGroup>
                            <h:panelGrid columns="2" columnClasses="middleCol,middleCol">
                                <h:graphicImage library="img" name="management.png" height="18px;"/>
                                <h:outputLabel value="Management"/>
                            </h:panelGrid>
                        </h:panelGroup>
                    </f:facet>
                    <h:form id="subManagement">
                        <h:panelGrid id ="subManagementPanel" columns="4" styleClass="panelLinks" width="100%"                             
                                 columnClasses="subStatusCol2,subStatusCol2,subStatusCol2,subStatusCol2">                    
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Main')}" 
                                             value="Main" 
                                             render="subManagementPanel,managementPanel"
                                             execute=":subManagement"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Main')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Launch')}" 
                                             value="Launch" 
                                             render="subManagementPanel,managementPanel"
                                             execute=":subManagement,"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Launch')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Monitor')}" 
                                             value="Monitor" 
                                             render="subManagementPanel,managementPanel"
                                             execute=":subManagement"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Monitor')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Tests')}" 
                                             value="Tests" 
                                             render="subManagementPanel,managementPanel"
                                             execute=":subManagement"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Tests')}"/>                    
                        </h:panelGrid>
                    </h:form>
                    <br />
                    <h:outputText value="Information not available for non-administrators"
                                  rendered="#{!userBean.isAdmin()}"/>

                    <h:panelGrid id="managementPanel" columns="2" columnClasses="regularCol,topCol">                                                            
                        <h:form id="ldapForm">
                            <rich:panel id="ldapPanel"
                                        rendered="#{userBean.getActiveSub().equalsIgnoreCase('Main')}">
                                        <!-- rendered="{userBean.isAdmin()}" -->
                                <f:facet name="header">
                                    <h:outputText value="LDAP Configuration" />
                                </f:facet>
                                <h:panelGrid columns="2">                        
                                    <h:outputText value="Host: " />
                                    <h:inputText value="#{managerBean.host}" />
                                    <h:outputText value="Port: " />
                                    <h:inputText value="#{managerBean.port}" />
                                    <h:outputText value="cn: " />
                                    <h:inputText value="#{managerBean.cn}" />
                                    <h:outputText value="Password: " />
                                    <h:inputSecret value="#{managerBean.password}" redisplay="true" />
                                    <h:outputText value="Group (OU): " />
                                    <h:inputText value="#{managerBean.group}" />
                                    <h:outputText value="DCs: " />
                                    <h:inputText value="#{managerBean.dcs}" />
                                    <h:outputText value=" "/>
                                    <a4j:commandButton value="Save" 
                                                       action="#{managerBean.saveLdapInfo()}"
                                                       render="ldapPanel"
                                                       execute=":ldapForm"/>
                                </h:panelGrid>
                            </rich:panel>
                        </h:form> 
                        <h:form>
                        <rich:dataTable id="usersTable"
                                        value="#{usersBean.allUsers}" 
                                        var="user" 
                                        iterationStatusVar="it"                                      
                                        rows="15"
                                        rendered="#{userBean.getActiveSub().equalsIgnoreCase('Main')}"
                                        styleClass="rolesTable">
                            <rich:column>
                                <f:facet name="header">#</f:facet>
                                #{it.index}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Username</f:facet>
                                <h:outputText value="#{user.userName}" />
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Created</f:facet>
                                <h:outputText value="#{user.created}" />
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Last Connection</f:facet>
                                <h:outputText value="#{user.lastConnection}" />
                            </rich:column> 
                            <rich:column>
                                <f:facet name="header">Comment</f:facet>
                                <h:outputText value="#{user.comment}" />
                            </rich:column> 
                            <rich:column>  
                                <f:facet name="header">Roles</f:facet>
                                <a4j:commandLink styleClass="no-decor" 
                                                 render="editGrid" 
                                                 execute="@this"
                                                 action="#{rolesBean.setCurrentIndex(it.index)}"
                                                 oncomplete="#{rich:component('editPane')}.show()">
                                    <h:graphicImage library="img"
                                                    name="edit.png" 
                                                    alt="edit" />
                                    <a4j:param value="#{it.index}" 
                                               assignTo="#{usersBean.currentUserIndex}" />
                                    <f:setPropertyActionListener target="#{usersBean.editedUser}" 
                                                                 value="#{user}" />
                                </a4j:commandLink>
                            </rich:column>
                            <f:facet name="footer">
                                <rich:dataScroller page="#{usersBean.page}" />
                            </f:facet>
                        </rich:dataTable>  
                        </h:form>
                    </h:panelGrid>

                    <rich:popupPanel id="statPane" autosized="true">
                        <!--h:graphicImage library="img" name="ai.gif" alt="ai" /-->
                        <!--Please wait...-->
                    </rich:popupPanel>                

                    <rich:popupPanel header="Edit User Roles" 
                                     id="editPane" 
                                     domElementAttachment="parent" 
                                     width="600" 
                                     height="219"
                                     left="50"
                                     top="50"
                                     style="background-color: #FFDCDC">
                        <h:form>
                        <h:panelGrid columns="3" id="editGrid">                                                
                            <rich:panel style="width:560px;">
                                <!--f:facet name="header">
                                    <h:outputText value="Roles"/>
                                </f:facet-->
                                <rich:pickList value="#{rolesBean.selectedRoles}" 
                                               sourceCaption="Available roles" 
                                               targetCaption="Current roles" 
                                               listWidth="165px" 
                                               listHeight="100px" 
                                               orderable="true">
                                    <f:selectItems value="#{rolesBean.roles}" 
                                                   var="role" 
                                                   itemValue="#{role}" 
                                                   itemLabel="#{role.roleName}" />
                                    <f:converter converterId="rolesConverter" />
                                </rich:pickList>
                            </rich:panel>                                                
                        </h:panelGrid>
                        <a4j:commandButton value="Store" 
                                           action="#{usersBean.store}" 
                                           render="usersTable" 
                                           execute="editPane"
                                           oncomplete="#{rich:component('editPane')}.hide(); #{rolesBean.removeNewRoles()}; return false;" />
                        <a4j:commandButton value="Cancel" 
                                           onclick="#{rich:component('editPane')}.hide(); return false;" />
                        </h:form>
                    </rich:popupPanel>               
                </rich:tab>

                <rich:tab header="Monitor"
                          id="Monitor"
                          onenter="setActiveTab('Monitor')"
                          onleave="setActiveSub('Main')"
                          contentClass="richTabContent">
                    <f:facet name="header">
                        <h:panelGroup>
                            <h:panelGrid columns="2" columnClasses="middleCol,middleCol">
                                <h:graphicImage library="img" name="monitor.png" height="18px;"/>
                                <h:outputLabel value="Monitor"/>
                            </h:panelGrid>
                        </h:panelGroup>
                    </f:facet>                
                    <h:form id="subMonitor">
                        <h:panelGrid id ="subMonitorPanel" columns="4" styleClass="panelLinks" width="100%"                             
                                 columnClasses="subStatusCol2,subStatusCol2,subStatusCol2,subStatusCol2">                    
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Main')}" 
                                             value="Main" 
                                             render="subMonitorPanel,myMonitorPanel"
                                             execute=":subMonitor"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Main')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Launch')}" 
                                             value="Launch" 
                                             render="subMonitorPanel,myMonitorPanel"
                                             execute=":subMonitor"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Launch')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Monitor')}" 
                                             value="Monitor" 
                                             render="subMonitorPanel,myMonitorPanel"
                                             execute=":subMonitor"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Monitor')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Tests')}" 
                                             value="Tests" 
                                             render="subMonitorPanel,myMonitorPanel"
                                             execute=":subMonitor"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Tests')}"/>                    
                        </h:panelGrid>
                    </h:form>
                    <br />
                        <h:panelGrid id="myMonitorPanel">
                        </h:panelGrid>
                </rich:tab>
             
                <rich:tab header="My account"
                          id="MyAccount"
                          onenter="setActiveTab('MyAccount')"
                          onleave="setActiveSub('Main')"
                          contentClass="richTabContent"> 
                    <f:facet name="header">
                        <h:panelGroup>
                            <h:panelGrid columns="2" columnClasses="middleCol,middleCol">
                                <h:graphicImage library="img" name="account.png" height="18px;"/>
                                <h:outputLabel value="My Account"/>
                            </h:panelGrid>
                        </h:panelGroup>
                    </f:facet>
                    <h:form id="subAccount">
                        <h:panelGrid id ="subAccountPanel" columns="4" styleClass="panelLinks" width="100%"                             
                                 columnClasses="subStatusCol2,subStatusCol2,subStatusCol2,subStatusCol2">                    
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Main')}" 
                                             value="Main" 
                                             render="subAccountPanel,myAccountPanel"
                                             execute=":subAccount"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Main')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Launch')}" 
                                             value="Launch" 
                                             render="subAccountPanel,myAccountPanel"
                                             execute=":subAccount"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Launch')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Monitor')}" 
                                             value="Monitor" 
                                             render="subAccountPanel,myAccountPanel"
                                             execute=":subAccount"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Monitor')}"/>
                            <a4j:commandLink styleClass="headerLinks" 
                                             action="#{userBean.changeSub('Tests')}" 
                                             value="Tests" 
                                             render="subAccountPanel,myAccountPanel"
                                             execute=":subAccount"
                                             disabled="#{userBean.activeSub.equalsIgnoreCase('Tests')}"/>                    
                        </h:panelGrid>
                    </h:form>
                    <br />
                    <h:panelGrid id="myAccountPanel" styleClass="appTable">
                        <h:form id="myAccountForm">
                            <rich:dataTable value="#{appsBean.allApps}"
                                            var="app"
                                            iterationStatusVar="it" 
                                            id="myAccountTable" 
                                            rows="20"
                                            rendered="#{userBean.getActiveSub().equalsIgnoreCase('Main')}">
                                <rich:column>
                                    <f:facet name="header">Logo</f:facet>
                                    <h:graphicImage name="#{app.logo}" 
                                                    library="img" 
                                                    height="24px"/>
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">App</f:facet>
                                    <h:outputText value="#{app.name}" />
                                </rich:column>                        
                                <rich:column>
                                    <f:facet name="header">Status</f:facet>
                                    <h:outputText value="#{app.status}" />
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">Actions</f:facet>
                                    <h:selectOneMenu value="#{appsBean.action}">    
                                        <f:selectItem noSelectionOption="true"/>
                                        <f:selectItem itemLabel="Install" 
                                                      itemValue="install" 
                                                      itemDisabled="#{appsBean.isAvailable(app.name)}" />
                                        <f:selectItem itemLabel="Uninstall"
                                                      itemValue="uninstall"
                                                      itemDisabled="#{appsBean.isInstalled(app.name)}" />
                                    </h:selectOneMenu>
                                </rich:column>                          
                                <f:facet name="footer">
                                    <rich:column colspan="4">
                                        <a4j:commandButton value="Submit" render="myAccountTable" execute=":myAccountFrom" />
                                    </rich:column>
                                </f:facet>                        
                            </rich:dataTable>
                            <h:panelGrid columns="2" rendered="#{userBean.getActiveSub().equalsIgnoreCase('Main')}">
                                <br />
                                <br />                                               
                                <br />
                                <h:form id="pbForm">
                                    <rich:progressBar mode="ajax" 
                                                      value="50" 
                                                      interval="500" 
                                                      id="pb"
                                                      enabled="#{userBean.activeTab.equalsIgnoreCase('MyAccount')}" 
                                                      minValue="0" 
                                                      maxValue="100">
                                        <!--f:facet name="initial">
                                            <h:panelGroup>
                                                <h:outputText value="Process hasn't started yet" />
                                                <a4j:commandButton action="{progressBarBean.startProcess}" value="Start Process" execute="@form"
                                                    render="pb" rendered="{progressBarBean.buttonRendered}" style="margin: 9px 0px 5px;" />
                                            </h:panelGroup>
                                        </f:facet>
                                        <f:facet name="finish">
                                            <h:panelGroup>
                                                <h:outputText value="Process Done" />
                                                <a4j:commandButton action="{progressBarBean.startProcess}" value="Restart Process" execute="@form"
                                                    render="pb" rendered="{progressBarBean.buttonRendered}" style="margin: 9px 0px 5px;" />
                                            </h:panelGroup>
                                        </f:facet-->
                                        <h:outputText value="50 %" />

                                        <!-- Update the progress for each AJAX update -->
                                        <a4j:ajax event="begin" listener="#{progressBarBean.increment}" />
                                    </rich:progressBar>
                                </h:form>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGrid>
                </rich:tab> 
                                                                                                                                                                                                                
            </rich:tabPanel>
                
            <!--/h:form-->
        </div>
        </div>
        <div id="footerDiv">                    
            <rich:panel id="footerPanel">     
                <h:panelGrid columns="3" columnClasses="footerleft,footercenter,footerright">
                    <h:outputText value="v1.0" />
                    <h:outputText value="&#169;Copyright" />
                    <h:graphicImage library="img" 
                                    name="logocediant.png" 
                                    height="32px" />
                </h:panelGrid>
            </rich:panel> 
        </div>
    </h:body>
</f:view>
</html>    
    
